% Created 2020-04-02 Thu 20:47
% Intended LaTeX compiler: pdflatex
\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage[a4paper, margin=1in]{geometry} \usepackage[utf8]{inputenc}
\usepackage{tikz}
\usetikzlibrary{positioning,arrows}
\setcounter{secnumdepth}{1}
\author{Omar Alkersh - alkersho}
\date{\today}
\title{Assignment 4 Specification and Requirements Documents}
\hypersetup{
 pdfauthor={Omar Alkersh - alkersho},
 pdftitle={Assignment 4 Specification and Requirements Documents},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 26.3 (Org mode 9.3.6)},
 pdflang={English}}
\begin{document}

\maketitle
The specification for \emph{Two Dots} consists of \texttt{Controller}, the main controller in the CV, \texttt{View}, the module responsible for the view, \texttt{BoardT}, the module holding the board information, \texttt{GameState} interface, the interface responsible for the win and lose conditions, and the three implementing modules of \texttt{GameState}.

The game is a 2 dimensional board which consists of coloured dots. The main action of the game is to connect at least two adjacent dots, not diagonally. Connecting dots consumes them, lowering the above dots to fill the gap then populates the empty top spots with new random dots. The win and lose conditions are defined by the game type.

There are three specified game types:

\begin{itemize}
\item Timer:
\begin{itemize}
\item Gives the player a timer until the game is finished. The player aims to achieve the highest score during the time by connecting dot.
\end{itemize}
\item Score:
\begin{itemize}
\item The player tries to achieve a set score. When achieved the game ends and the player "wins"
\end{itemize}
\item Moves:
\begin{itemize}
\item The player has a limited number of moves before the game is over. During which he have to score a set score else he loses.
\end{itemize}
\end{itemize}

To start the game type the command \texttt{make run} from the project source, where the makefile is.

\newpage
\section{Board Module}
\label{sec:org5c9018a}
\subsection*{Template Module}
\label{sec:org1d3c8ca}
BoardT

\subsection*{Uses}
\label{sec:org0ae7376}
GameState

\subsection*{Syntax}
\label{sec:org11d3d01}

\subsubsection*{Exported Constants}
\label{sec:org7320167}
SIZE = 6

\subsubsection*{Exported Types}
\label{sec:org783fb0c}

Colour = \{Blue, Green, Pink, Red, Orange\}\\
BoardT = ?

\subsubsection*{Exported Access Program}
\label{sec:org64d09d5}
\begin{center}
\begin{tabular}{l|l|l|l}
Routine name & In & Out & Exception\\
\hline
BoardT & GameState & BoardT & \\
consume & set(tuple(i: \(\mathbb{N}\), j: \(\mathbb{N}\))) &  & IndexOutOfBoundsException, IllegalArgumentException\\
updateBoard &  &  & \\
getCell & \(\mathbb{N}\), \(\mathbb{N}\) & Colour & IndexOutOfBoundsException\\
\end{tabular}
\end{center}

\subsubsection*{Semantics}
\label{sec:org8ba1bd5}

\begin{itemize}
\item State Variables
\label{sec:orgef9cfbf}

b: seq (seq (Colour))

state: GameState

\item State Invariant
\label{sec:org2e8a45a}

\(|b| = SIZE\)

\(\forall i, j: i, j \in \mathbb{N} \land 0 \leq i,j < |b| \bullet |b[i]| = |b[j]| \land |b[i]| = SIZE\)

\item Assumptions
\label{sec:orgbfa7530}

BoardT is called before any other routine is called.

\item Access Routine Semantics
\label{sec:orgc177c88}

\texttt{new} BoardT(gs):
\begin{itemize}
\item transition: \(state, b := gs, board\) such that \(\forall i, j: i,j \in \mathbb{N} \land 0 \leq i,j < SIZE \bullet board[i][j] \neq Null\)
\item output: \(out := self\)
\item exception: None
\end{itemize}


consume(set):
\begin{itemize}
\item transition: The set of "coordinates" are set to \texttt{Null}, then it calls state.update(|set|, getCell(c)) where \(c \in set\).
\begin{itemize}
\item Coordinates are entries in the 2D array.
\item Down means that the object moves to the row below. If an object is at s[i][j], where \(i \neq 0\) then moving down will put it at s[i-1][j].
\end{itemize}
\item output: None
\item Exception: \(exc:= \exists c: c \in set \bullet ¬ (0 \leq c.i < SIZE \land 0\leq c.j < SIZE) \implies IndexOutOfBoundsException\) | \(\lnot \forall i, j ,k, l : i, j, k, l \in \mathbb{N} \land i < SIZE \land j < SIZE \land k < SIZE \land l < SIZE \bullet b[i][j] = b[k][l] \implies IllegalArgumentException\)
\end{itemize}

updateBoard()
\begin{itemize}
\item transition: All non-null cells are moved "down". Finally the remaining \texttt{Null} cells are set to different colours.
\item output: None
\item Exception: None
\end{itemize}

getCell(i, j)
\begin{itemize}
\item transition: None
\item output: \(out := b[i][j]\)
\item Exception: \(exc := ¬ (0 \leq i < SIZE \land 0 \leq j < SIZE) \implies IndexOutOfBoundsException\)
\end{itemize}

\newpage
\end{itemize}
\section{Controller Module}
\label{sec:org1e7d1ec}
\subsection*{Abstract Object Module}
\label{sec:org7926a8c}
Controller
\subsection*{Uses}
\label{sec:org2ab7d25}
GameState, BoardT, View
\subsection*{Syntax}
\label{sec:org3a1d4b2}
\subsubsection*{Exported Constants}
\label{sec:org50ab274}
\subsubsection*{Exported Types}
\label{sec:orgf109b98}
\subsubsection*{Exported Access Program}
\label{sec:orgac8c24a}
\begin{center}
\begin{tabular}{l|l|l|l}
Routine name & In & Out & Exception\\
\hline
Controller &  & Controller & \\
\end{tabular}
\end{center}

\subsubsection*{Semantics}
\label{sec:orgd7152da}
\begin{itemize}
\item State Variables
\label{sec:orgd2c9c57}

board: BoardT

game: GameState

win: View

\item Environment Variables
\label{sec:org03c9f86}
\item State Invariant
\label{sec:org307295e}
\item Assumptions
\label{sec:orgce7e2f6}

\item Access Routine Semantics
\label{sec:orga7d0a88}

\texttt{new} Controller:
\begin{itemize}
\item transition: calls View with the correct parameters.
\item out: None
\item Exceptions: None
\end{itemize}
\item Local Functions
\label{sec:org6a0fb67}


\newpage
\end{itemize}
\section{View Module}
\label{sec:org636c230}
\subsection*{Abstract Object Module}
\label{sec:org1d436cd}
View
\subsection*{Uses}
\label{sec:orgfa3cbc2}

\subsection*{Syntax}
\label{sec:org7cd54f2}
\subsubsection*{Exported Constants}
\label{sec:org8e59869}
\subsubsection*{Exported Types}
\label{sec:org4a458de}
View = ?
\subsubsection*{Exported Access Program}
\label{sec:orgfd8ea0e}
\begin{center}
\begin{tabular}{l|l|l|l}
Routine name & In & Out & Exception\\
\hline
View & WindowListener, ActionListener, ActionListener &  & \\
gameMenu & ActionListener, ActionListener, ActionListener &  & \\
startGame & GameState, BoardT, MouseListener, KeyListener &  & \\
showPause & ActionListener, ActionListener, ActionListener &  & \\
showWin &  &  & \\
showLose &  &  & \\
updateBoard &  &  & \\
connectToMouse & \(\mathbb{N}, \mathbb{N}\) &  & \\
drawConnection & \(\mathbb{N}, \mathbb{N}\), \(\mathbb{N}, \mathbb{N}\) &  & \\
updateLabels &  &  & \\
\end{tabular}
\end{center}

\subsubsection*{Semantics}
\label{sec:org312587b}
\begin{itemize}
\item State Variables
\label{sec:org34f3c17}

board: BoardT

game: GameState

\item Environment Variables
\label{sec:orga20d49b}
screen : The screen.
\item State Invariant
\label{sec:orgd16362a}
\item Assumptions
\label{sec:org2057789}
All functions are called after View has been called.

startGame is called after gameMenu.

gamePause is called after startGame.

showWin and showLose are called only when \(state.running() = false\).

updateBoard is called only after startGame and while \(state.running() = true\).

\item Access Routine Semantics
\label{sec:org4cd8a51}

\texttt{new} View():
\begin{itemize}
\item transition: screen := Shows a window in the screen with buttons; "Start Game", "Quit".
\begin{itemize}
\item Start Game: Returns "Start Game" message.
\item Quit: Returns "Quit" message.
\end{itemize}
\item output: out := Selected option.
\item Exception: None
\end{itemize}

gameMenu()
\begin{itemize}
\item transition: screen := Shows a menu with a button for each of the available game mode.
\item output: The code for the selected game mode.
\item Exception: None
\end{itemize}

startGame(game, b):
\begin{itemize}
\item transition: game, board, screen := game, b, shows a grid with coloured dots to represent the board with b[0] being the bottom most row and labels to represent the current game mode/state.
\item output: None.
\item Exception: None
\end{itemize}

showPause():
\begin{itemize}
\item transition: screen := Shows a menu with "Continue" and "Quit" options.
\begin{itemize}
\item Also calls game.pause() if game is StateTimer
\end{itemize}
\item output: The chosen option.
\item Exception: None
\end{itemize}

showWin():
\begin{itemize}
\item transition: screen := Shows a "win" message with buttons "Quit".
\item output: The "Quit" message when selected.
\item Exception: None
\end{itemize}

showLose():
\begin{itemize}
\item transition: screen := Shows a "lose" message with buttons "Quit".
\item output: The "Quit" message when selected.
\item Exception: None
\end{itemize}

updateBoard():
\begin{itemize}
\item transition: screen := update the grid to represent the \texttt{board}.
\item output: None
\item Exception: None
\end{itemize}

drawConnection(coord1, coord2, c):
\begin{itemize}
\item transition: screen := Draws a coloured line same colour as \texttt{c} from dot at coord1 to dot at coord2.
\item output: None
\item Exception: None
\end{itemize}

connectToMouse(coord, c):
\begin{itemize}
\item transition: screen := Draw a coloured line same colour as \texttt{c} from dot at coord to the current mouse position.
\item output: None
\item Exception: None
\end{itemize}

updateLabels():
\begin{itemize}
\item transitions: screen := updates the game labels to reflect the \texttt{state} data.
\item output: None
\item Exception: None
\end{itemize}

\item Local Functions
\label{sec:org76f48d4}


\newpage
\end{itemize}
\section{Game State Module}
\label{sec:orgb7d5f38}
\subsection*{Interface}
\label{sec:org2fe308e}
GameState

\subsection*{Uses}
\label{sec:org7736a91}
None

\subsection*{Syntax}
\label{sec:org03a2ebe}
\subsubsection*{Exported Constants}
\label{sec:orgfdf6067}
None

\subsubsection*{Exported Types}
\label{sec:orgfa1c798}
State = \{Win, Lose, Running\}

\subsubsection*{Exported Access Program}
\label{sec:org4cffe4e}
\begin{center}
\begin{tabular}{l|l|l|l}
Routine name & In & Out & Exception\\
\hline
update &  &  & \\
update & \(\mathbb{N}, Colour\) &  & \\
state &  & State & \\
running &  & \(\mathbb{B}\) & \\
\end{tabular}
\end{center}

\subsubsection*{Semantics}
\label{sec:org02ee8b8}
\begin{itemize}
\item State Variables
\label{sec:orgb88e2ca}
state: State

\item Access Routine Semantics
\label{sec:org57b01f7}

state()
\begin{itemize}
\item transition: None
\item output: \(out := state\)
\item Exception: None
\end{itemize}

running()
\begin{itemize}
\item transition: None
\item output: \(out := state = Running\)
\item Exception: None
\end{itemize}

\newpage
\end{itemize}
\section{State Timer Module}
\label{sec:orgfe3fbbb}
\subsection*{Template Module inherits GameState}
\label{sec:orgf1c2d82}
StateTime

\subsection*{Uses}
\label{sec:org942a21a}
GameState, BoardT

\subsection*{Syntax}
\label{sec:org4471f9c}
\subsubsection*{Exported Constants}
\label{sec:org8e33852}
None

\subsubsection*{Exported Types}
\label{sec:org7dbc2f9}
StateTime = ?

\subsubsection*{Exported Access Routine}
\label{sec:org8ec65b6}
\begin{center}
\begin{tabular}{l|l|l|l}
Routine name & In & Out & Exception\\
\hline
StateTime & \(\mathbb{N}\), \(\mathbb{N}\) & StateTime & \\
getScore &  & \(\mathbb{N}\) & \\
getRemTime &  & \(\mathbb{R}\) & \\
pause &  &  & \\
unPause &  &  & \\
isPaused &  & \(\mathbb{B}\) & \\
\end{tabular}
\end{center}

\subsubsection*{Semantics}
\label{sec:org2439a74}
\begin{itemize}
\item State Variables
\label{sec:org4d7e425}

\(endTime: \mathbb{R}\)

\(curTime: \mathbb{R}\)

\(score: \mathbb{N}\)

\(scoreGoal: \mathbb{N}\)

\(paused: \mathbb{B}\)

\item Environment Variables
\label{sec:org4507483}

sysTime: The current system time in seconds.

\item State Invariant
\label{sec:orgab4999d}

\(endTime > 0\)

\item Assumption
\label{sec:org68ae4c3}

StateTime is called before any other method is called.

\item Access Routine Semantics
\label{sec:org195431f}

\texttt{new} StateTime(i, t):
\begin{itemize}
\item transition: \(paused, state, curTime, endTime, score, scoreGoal := false, Running, sysTime, sysTime + t, 0, i\)
\item output: \(out := self\)
\item Exception: None
\end{itemize}

update()
\begin{itemize}
\item transition: \(curTime, state := sysTime, (endTime > curTime \implies Running | endTime \leq curTime \implies (score < scoreGoal \implies Lose | True \implies Win))\)
\item output: None
\item Exception: None
\end{itemize}

update(n, c)
\begin{itemize}
\item transition: \(paused, score, curTime, state := False, score + calcScore(n, c), sysTime, (endTime > curTime \implies Running | endTime \leq curTime \implies (score < scoreGoal \implies Lose | True \implies Win))\)
\item output: None
\item Exception: None
\end{itemize}

getScore()
\begin{itemize}
\item transition:
\item output: \(out := score\)
\item Exception: None
\end{itemize}

getRemTime()
\begin{itemize}
\item transition:
\item output: \(out := endTime - curTime\)
\item Exception: None
\end{itemize}

unPause()
\begin{itemize}
\item transition: \(paused := False\)
\item output: None
\item Exception: None
\end{itemize}

pause()
\begin{itemize}
\item transition: \(paused := True\)
\item output: None
\item Exception: None
\end{itemize}

isPaused()
\begin{itemize}
\item transition: None
\item output: \(out := paused\)
\item Exception: None
\end{itemize}

\item Local Functions
\label{sec:orgff37ccf}

calcScore: \(\mathbb{N} \times Colour \rightarrow \mathbb{N}\) \\
\(calcScore t = ?\)

\newpage
\end{itemize}
\section{State Score Module}
\label{sec:org425cf71}
\subsection*{Template Module Inherits GameState}
\label{sec:org9b67087}
StateScore
\subsection*{Uses}
\label{sec:orga2d8a28}
GameState
\subsection*{Syntax}
\label{sec:org3717dd1}
\subsubsection*{Exported Constants}
\label{sec:orgff4cff9}
None

\subsubsection*{Exported Types}
\label{sec:orgaff1153}
StateScore = ?

\subsubsection*{Exported Access Routine}
\label{sec:orgd6e8205}
\begin{center}
\begin{tabular}{l|l|l|l}
Routine name & In & Out & Exception\\
\hline
StateScore & \(\mathbb{N}\) & StateScore & \\
getScore &  & \(\mathbb{N}\) & \\
getMaxScore &  & \(\mathbb{N}\) & \\
\end{tabular}
\end{center}

\subsubsection*{Semantics}
\label{sec:org44fe22d}

\begin{itemize}
\item State Variables
\label{sec:orgdbac3a3}

\(score: \mathbb{N}\)

\(scoreGoal: \mathbb{N}\)

\item State Invariant
\label{sec:org0cf5d7b}

\(0 \leq score \leq scoreGoal\)

\item Assumptions
\label{sec:orgf7349b4}

StateScore is called before any other routine.

\item Access Routine Semantics
\label{sec:org31e670c}

\texttt{new} StateScore(i)
\begin{itemize}
\item transition: \(state, score, scoreGoal := Running, 0, i\)
\item output: \(out := self\)
\item Exception None
\end{itemize}

update()
\begin{itemize}
\item transition: None
\item output: None
\item Exception: None
\end{itemize}

update(n, c)
\begin{itemize}
\item transition: \(score, state := score + calcScore(n, c), (score \geq scoreGoal \implies Win | True \implies Running)\)
\item output: None
\item Exception: None
\end{itemize}

getScore()
\begin{itemize}
\item transition:
\item output: \(out := score\)
\item Exception: None
\end{itemize}

getMaxScore()
\begin{itemize}
\item transition:
\item output: \(out := scoreGoal\)
\item Exception: None
\end{itemize}

\item Local Functions
\label{sec:org79626f0}

calcScore: \(\mathbb{N} \times Colour \rightarrow \mathbb{N}\) \\
\(calcScore t = ?\)

\newpage
\end{itemize}
\section{State Moves Module}
\label{sec:orgffb5519}
\subsection*{Template Module Inherits GameState}
\label{sec:org082ad2a}
StateMoves

\subsection*{Uses}
\label{sec:orgbd9c981}
GameState

\subsection*{Syntax}
\label{sec:orgee588d1}

\subsubsection*{Exported Constants}
\label{sec:org5f8be7f}

\subsubsection*{Exported Types}
\label{sec:org367f5a5}
StateMoves

\subsubsection*{Exported Access Routine}
\label{sec:orgfe83c05}
\begin{center}
\begin{tabular}{l|l|l|l|}
Routine name & In & Out & Exception\\
\hline
StateMoves & \(\mathbb{N}\), \(\mathbb{N}\) & StateMoves & \\
getScore &  & \(\mathbb{N}\) & \\
getScoreGoal &  & \(\mathbb{N}\) & \\
getRemMoves &  & \(\mathbb{N}\) & \\
\end{tabular}
\end{center}

\subsubsection*{Semantics}
\label{sec:orge4a727e}

\begin{itemize}
\item State Variables
\label{sec:org89c5800}

\(score := \mathbb{N}\)

\(scoreGoal := \mathbb{N}\)

\(moves := \mathbb{N}\)

\(maxMoves := \mathbb{N}\)

\item State Invariant
\label{sec:orge7957f8}

\(0 \leq score \leq scoreGoal\)

\(0 \leq moves \leq maxMoves\)

\item Assumptions
\label{sec:orge04b4f2}

StateMoves is called before any other routine.

\item Access Routine Semantics
\label{sec:orgab3f094}

\texttt{new} StateMoves(i, m):
\begin{itemize}
\item transition: \(score, scoreGoal, moves, maxMoves := 0, i, 0, m\)
\item output: \(out := self\)
\item Exception: None
\end{itemize}

update():
\begin{itemize}
\item transition: None
\item output: None
\item Exception: None
\end{itemize}

update(n, c)
\begin{itemize}
\item transition: \(moves, score, state := moves + 1, score + calcScore(n, c), (maxMoves > moves \implies Running | maxMoves \leq moves \implies (score \geq scoreGoal \implies Win|True \implies Lose))\)
\end{itemize}

getScore()
\begin{itemize}
\item transition:
\item output: \(out := score\)
\item Exception: None
\end{itemize}

getScoreGoal()
\begin{itemize}
\item transition:
\item output: \(out := scoreGoal\)
\item Exception: None
\end{itemize}

getRemMoves()
\begin{itemize}
\item transition:
\item output: \(out := maxMoves - moves\)
\item Exception: None
\end{itemize}

\item Local Functions
\label{sec:org1b0b676}

calcScore: \(\mathbb{N} \times Colour) \rightarrow \mathbb{N}\) \\
\(calcScore t = ?\)

\newpage
\end{itemize}
\section{Bubblesort CFG}
\label{sec:org4293b53}
\begin{center}
  \begin{tikzpicture}[->, >=stealth', shorten >=1pt, auto, node distance=2cm, semithick,
roundnode/.style={circle, draw=black, very thick, minimum size=1cm}]
    \node[roundnode] (start) {Begin};
    \node[roundnode] [below of=start] (for1) {For};
    \node[roundnode] [below of=for1] (for2) {For};
    \node[roundnode] [below of=for2] (if) {If};
    \node[roundnode] [below of=if] (ifEnd) {end If};
    \node[roundnode] [below of=ifEnd] (forEnd2) {end For};
    \node[roundnode] [below of=forEnd2] (forEnd1) {end For};
    \node[roundnode] [below of=forEnd1] (end) {end};

    \path
      (start) edge (for1)
      (for1) edge (for2)
      (for2) edge (if)
      (if) edge (ifEnd)
           edge[left,in=-180,out=-180] node {$arr[j] < arr[j+1]$} (ifEnd)
      (ifEnd) edge (forEnd2)
      (forEnd2) edge (forEnd1)
      (forEnd1) edge (end)

      (forEnd2) edge[left,in=0,out=0] (for2)
      (forEnd1) edge[right,in=0,out=0] (for1);
  \end{tikzpicture}
\end{center}

\section{Known Bugs}
\label{sec:org18661f0}
\begin{itemize}
\item Game doesn't pause
\begin{itemize}
\item Should pause when window focus is lost or when the user presses \texttt{esc}.
\end{itemize}
\item The dot hit box is not wide, player needs to click in the centre of the dot.
\end{itemize}
\end{document}